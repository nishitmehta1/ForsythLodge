// Generated by CoffeeScript 1.9.3
(function($) {
  var init;
  init = function() {

    /* LOADER MODAL FOR TEAM MEMBERS, SHOWCASE, PORTFOLIO AND BLOG SECTIONS */
    var $loaderModal, loadProgressIndicator, loader, loaderLauncher, loaderModal;
    loadProgressIndicator = function() {
      var prog;
      prog = $("span.progress_ball");
      return prog.toggleClass("show");
    };
    loader = new SVGLoader(document.getElementById('loader'), {
      speedIn: 250,
      easingIn: mina.easeinout,
      onEnd: loadProgressIndicator
    });
    loaderModal = document.querySelector(".loader-modal");
    $loaderModal = $(loaderModal);
    $loaderModal.on("click", ".close-handle", function(e) {
      $loaderModal.scrollTop(0);
      $loaderModal.fadeOut(250, function() {
        return $loaderModal.attr('class', 'loader-modal');
      });
    });
    loaderLauncher = function(options) {
      var className, content, inject;
      content = options.content;
      className = options.className;
      inject = options.inject;
      loader.show();
      setTimeout(function() {
        if (className !== 'undefined') {
          $loaderModal.addClass(className);
        }
        $loaderModal.html('').append($("<span class='close-handle' />"));
        return (function(content, inject) {
          return $.ajax({
            url: content,
            error: function(data) {
              return $loaderModal.append(themeConfig.ajaxErrorMessage.open + content + themeConfig.ajaxErrorMessage.close).fadeIn(250, function() {
                loader.hide();
                return loadProgressIndicator();
              });
            },
            success: function(data) {
              var $main, colorSet, injectable, window_height;
              window_height = $(window).height();
              $main = $(data).find(".main");
              colorSet = $main.find("").find("[data-colorset]").data("colorset") || "";
              injectable = $main.addClass('ajaxed ' + colorSet).css("min-height", window_height);
              return $loaderModal.append(injectable).fadeIn(250, function() {
                loadProgressIndicator();
                loader.hide();
                return (function(selector) {
                  if (!(document.body.style['webkitPerspective'] !== void 0 || document.body.style['MozPerspective'] !== void 0)) {
                    return;
                  }
                  _p.slice(document.querySelectorAll('a.roll')).forEach(function(a) {
                    a.innerHTML = '<span data-title="' + a.text + '">' + a.innerHTML + '</span>';
                  });
                })();
              });
            }
          });
        })(content, inject);
      }, 250);
    };

    /* SECTION: TEAM */
    return $(".linkify").on("click", function(e) {
      var content;
      e.preventDefault();
      _p.debugLog("Class 'ajax-call' detected.");
      content = e.currentTarget.href;
      return loaderLauncher({
        content: content,
        className: "loader-modal-content"
      });
    });
  };
  return (document.getElementById('loader')) && (document.querySelector(".loader-modal")) && init();
})(jQuery);
